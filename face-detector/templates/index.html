<html>
    <head>
        <title>jQuery ajax polling</title>
    </head>
<body>

<!-- where the response will be displayed -->
<div id='response'></div>
<img id="image" src="../static/loader.gif" alt="image"/>
 
<script src="../static/jquery.min.js"></script>
<script>
$(document).ready(function() {

    // host:port
    var serverUrl = '{{ serverUrl }}';

    (function poll() {
        setTimeout(function() {

            // show that something is loading
            $('#response').html("<b>Loading response...</b>");

            $.ajax({
                type: 'GET',
                url: 'http://' + serverUrl + '/faces',
                data: $(this).serialize()
            })
            .done(function(data){
                // show the response
                $('#response').html(data);
                $('#image').attr("src","http://" + serverUrl + "/frame");
                poll();
            })
            .fail(function(jqXHR, status, err) {
                $('#response').html("<p style='color: red'>Error in the request</p>");
            });
        }, 1000);
    })();
});
</script>
 
</body>
</html>
